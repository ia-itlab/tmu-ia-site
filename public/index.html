<html>

<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="style/style.css">


    <link rel="shortcut icon" href="./images/ファビコン (logo)/favicon.ico">

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="./javascript/fademover.js"></script>
    <script type="text/javascript" src="./javascript/index.js"></script>
    <script type="text/javascript" src="./javascript/studio.js"></script>
    <title>東京都立大学システムデザイン学部インダストリアルアート学科/学域</title>

    <!-- font -->
    <script>
        (function (d) {
            var config = {
                kitId: 'eby3bgi',
                scriptTimeout: 3000,
                async: true
            },
                h = d.documentElement, t = setTimeout(function () { h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive"; }, config.scriptTimeout), tk = d.createElement("script"), f = false, s = d.getElementsByTagName("script")[0], a; h.className += " wf-loading"; tk.src = 'https://use.typekit.net/' + config.kitId + '.js'; tk.async = true; tk.onload = tk.onreadystatechange = function () { a = this.readyState; if (f || a && a != "complete" && a != "loaded") return; f = true; clearTimeout(t); try { Typekit.load(config) } catch (e) { } }; s.parentNode.insertBefore(tk, s)
        })(document);
    </script>

    <style>
        h5.card-title {
            font-size: 1.2em;
        }

        h3.title {
            font-size: 1.2em;
        }

        h3.title>a {
            color: black;
            text-decoration: none;
        }

        h3.title>a:hover {
            color: white;
            background-color: black;
            text-decoration: none;
        }

        .grid-sizer,
        .grid-item {
            float: left;
            border-radius: 5px;

        }

        .grid-item--width2 {
            width: 40%;

        }

        .grid-item--width3 {
            width: 60%;

        }


        /* 2 columns wide */
        .grid-item--width2 {
            width: 40%;
        }

        .grid-item--height2 {
            height: 200px;
        }

        .grid-item--height3 {
            height: 260px;
        }

        .grid-item--height4 {
            height: 360px;
        }

        /* clearfix */
        .grid:after {
            content: '';
            display: block;
            clear: both;
        }

        .grid-item>a {
            text-decoration: none;
        }

        .grid-item>a:hover {
            text-decoration: none;
        }

        .grid-item>a>.card {
            color: black;
            transition: background-color 2s, color 0.8s;


        }

        .grid-item>a>.card:hover {
            text-decoration: none;
            background-color: black;
            color: white;
            transition: background-color 2s, color, 1s;
        }

        .wrapper {
            animation: fadeIn 2.0s ease 0.0s 1 normal;
        }

        @keyframes fadeIn {

            /*animation-nameで設定した値を書く*/
            0% {
                opacity: 0
            }

            /*アニメーション開始時は不透明度0%*/
            100% {
                opacity: 1
            }

            /*アニメーション終了時は不透明度100%*/
        }
    </style>
    <!--
        テンプレ
    <li class="informationRow age2021 active">
        <div class="head">
            <span class="date">2021.10.04</span><span class="tag tag07"></span>
        </div>
        <h3 class="title">
            <a href="/news/topics/10530.html"></a>
        </h3>

    </li>
    -->
    <!-- 馬場が勝手に作ったスクレイピング ここから-->
    <script type="text/javascript">


        window.onload = function () {
            var msnry;
            var elem = document.querySelector('#awards');
            msnry = new Masonry(elem, {
                // options
                columnWidth: '.grid-sizer',
                itemSelector: '.grid-item',
                gutter: 0,
                percentPosition: true,
                originLeft: true,
            });

            var elem_topics = document.querySelector('#topics');
            var msnry_topics = new Masonry(elem_topics, {
                // options
                columnWidth: '.grid-sizer',
                itemSelector: '.grid-item',
                gutter: 0,
                percentPosition: true,
                originLeft: true,
            });


            var loadHTML = new Promise(function (resolve, reject) {
                // ia wiki から topicsデータを取得する
                {
                    var url = 'http://industrial-art.sd.tmu.ac.jp/wiki/doku.php\?id=website:topics';
                    var regexp = '@<!-- CONTENT -->(.*?)<!-- \/CONTENT -->@s';
                    var _html = './php/scrape.php?regexp=' + regexp + '&url=' + url;
                    var replace = 'topics';
                    //Httpリクエスを作る
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.open("GET", _html, true);
                    xmlhttp.onreadystatechange = function () {
                        //とれた場合Idにそって入れ替え
                        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                            var data = xmlhttp.responseText;
                            //xmlhttp.responseXML
                            //console.log(data);
                            var elem = document.getElementById(replace);
                            elem.innerHTML = data;
                            resolve(data);
                            //return data;
                        }
                    }
                    xmlhttp.send(null);
                }
            });
            loadHTML.then(function () {

                var grid_sizer = document.createElement('div');
                grid_sizer.classList.add('grid-sizer');
                document.getElementById('topics').appendChild(grid_sizer);

                var ols = document.querySelectorAll('ol.fix-media-list-overlap');

                let count_ol = 0;
                for (ol of ols) {

                    var col = document.createElement('div');
                    col.style.display = 'block'
                    if (count_ol == 0) {
                        col.classList.add('col', 'col-sm-12', 'col-lg-8', 'mt-3', 'g-4', 'grid-item');
                    }
                    else {
                        col.classList.add('col', 'col-sm-6', 'col-lg-4', 'mt-3', 'g-4', 'grid-item');
                    }
                    //col.innerHTML = 'div col';
                    // col -> card -> card-body
                    document.getElementById('topics').appendChild(col);
                    var card = document.createElement('div');

                    card.classList.add('card');

                    //card.innerHTML = 'card';
                    var card_body = document.createElement('div');
                    card_body.classList.add('card-body');

                    col.appendChild(card);
                    var lis = ol.querySelectorAll('li');

                    var img_card = document.createElement('img');
                    img_card.classList.add('card-img-top');
                    if (lis[1].querySelector('div').querySelector('a')) {
                        img_card.src = lis[1].querySelector('div').querySelector('a').href;
                    }
                    //console.log(lis[1]);


                    card.appendChild(img_card);
                    card.appendChild(card_body);

                    var a_link = document.createElement('a');
                    if (lis.length >= 4) {
                        if (lis[4].querySelector('div')) {
                            if (lis[4].querySelector('a')) {
                                a_link.href = lis[4].querySelector('div').querySelector('a').href;
                                a_link.target = '_blank';
                                //card.appendChild(a_link);
                                //a_link.appendChild(img_card);
                                a_link.appendChild(card);
                                col.appendChild(a_link);
                            }
                        }
                    }


                    // console.log(lis);
                    var h5_card_title = document.createElement('h5');
                    h5_card_title.classList.add('card-title');
                    h5_card_title.innerHTML = lis[0].innerHTML;
                    card_body.appendChild(h5_card_title);

                    var p_card_text = document.createElement('p');
                    p_card_text.classList.add('card-text');
                    p_card_text.innerHTML = lis[2].innerHTML;
                    card_body.appendChild(p_card_text);

                    var p_card_text_date = document.createElement('p');
                    p_card_text_date.classList.add('card-text', 'text-muted');
                    p_card_text_date.innerHTML = lis[3].innerHTML;
                    card_body.appendChild(p_card_text_date);

                    msnry_topics.appended(col);
                    //ul.innerHTML = '';
                    ol.remove();
                    //console.log('ol', ol);
                    count_ol++;
                }
                //uls.remove();

                document.querySelector('.dw-content').remove();
                //console.log('topics', document.getElementById('topics'));

                // カード画像は全部ロードが終わった後並べ替え作業をする
                var elements = document.querySelectorAll('.card-img-top');
                var count = 0;
                new Promise((resolve) => {
                    for (element of elements) {
                        //console.log(element);
                        var src_tmp = element.src;
                        element.src = '';
                        element.onload = function () {
                            count++;
                            msnry_topics.layout();
                            if (count == elements.length) {
                                resolve();
                            }
                        }
                        element.src = src_tmp;
                    }
                }).then(() => {
                    //console.log("done all loading");
                    msnry_topics.layout();
                });
            });



            var loadHTML = new Promise(function (resolve, reject) {

                // 大学ウェブサイトからニュースを取得する
                {
                    var url = 'https://www.sd.tmu.ac.jp/news.html';
                    var regexp = '@<li class="informationRow age202(?:.*?)>(.*?)</li>@s';
                    var _html = './php/scrape.php?regexp=' + regexp + '&url=' + url;
                    var replace = 'awards';
                    //Httpリクエスを作る
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.open("GET", _html, true);
                    xmlhttp.onreadystatechange = function () {
                        //とれた場合Idにそって入れ替え
                        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                            var data = xmlhttp.responseText;
                            //xmlhttp.responseXML
                            //console.log(data);
                            var elem = document.getElementById(replace);
                            elem.innerHTML = data;
                            resolve(data);
                            //return data;
                        }
                    }
                    xmlhttp.send(null);
                }


            });
            loadHTML.then(function () {
                var grid_sizer = document.createElement('div');
                grid_sizer.classList.add('grid-sizer');
                document.getElementById('awards').appendChild(grid_sizer);
                var lists = document.getElementById('awards').querySelectorAll('li');
                var lists_art = [];
                for (list of lists) {
                    if (list.querySelector('p.desc')) {

                        if (list.querySelector('p.desc').innerHTML.indexOf('インダストリアルアート') > 0) {
                            var col = document.createElement('div');
                            col.classList.add('col', 'col-sm-6', 'col-lg-4', 'mt-3', 'g-4', 'grid-item');

                            document.getElementById('awards').appendChild(col);
                            var card = document.createElement('div');
                            col.appendChild(card);
                            card.classList.add('card');
                            var card_body = document.createElement('div');
                            card_body.classList.add('card-body');
                            card.appendChild(card_body);
                            // h3タグにリンクのaタグがあるが，相対リンクで記載されているので，tmuへの絶対リンクへ文字列を置換する
                            list.querySelector('h3').classList.add('mt-3');
                            var link = list.querySelector('h3').querySelector('a');
                            var link_replaced = link.href.replace(/http.*news/u, 'https://www.sd.tmu.ac.jp/news');
                            //console.log(link_replaced);
                            list.style.display = 'block';
                            link.href = link_replaced;
                            list.querySelector('div.head').querySelector('span.date').classList.add('badge', 'bg-dark');
                            list.querySelector('div.head').querySelector('span.tag').remove();
                            //console.log(list);
                            lists_art.push(list);
                            list.querySelector('p.desc').classList.add('text-muted');
                            card_body.appendChild(list);
                            msnry.appended(col);

                        }
                        else {
                            list.remove();
                        }
                    }
                    else {
                        list.remove();
                    }
                }
                //console.log('awards', document.querySelector('#awards'));
                msnry.layout();
                //console.log(lists_art);
            })
        }
    </script>
</head>

<body>

    <header id="global-head">
        <script>
            $("#global-head").load("./parts/header.html");
        </script>
    </header>

    <div id="nav-toggle">
        <div>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <aside id="sidebar">
        <nav id="global-nav">
            <script type="text/javascript" src="./javascript/menu.js"></script>
        </nav>
    </aside>

    <div class="wrapper">
        <div class="centering">
            <main>

                <h2 class="page-title">Featured Topics<span>最新のインダストリアルアート学科の活動を紹介します</span></h2>
                <div id="topics" class="row row-cols-1 row-cols-md-3 g-3"></div>

                <h2 class="page-title mt-5">受賞<span>学生の受賞やイベント等</span></h2>
                <div id="awards" class="row row-cols-1 row-cols-md-3 g-3 ">

                </div>


        </div>

        <footer>
            <script>
                $("footer").load("./parts/footer.html");
            </script>
        </footer>
        </main>
    </div>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>

</body>

</html>