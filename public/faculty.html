<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <link rel="stylesheet" type="text/css" href="style/style.css">

  <link rel="shortcut icon" href="./images/ファビコン (logo)/favicon.ico">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script type="text/javascript" src="./javascript/fademover.js"></script>
  <script type="text/javascript" src="./javascript/index.js"></script>
  <title>FACULTY｜東京都立大学システムデザイン学部インダストリアルアート学科/学域</title>

  <!-- font -->
  <script>
    (function (d) {
      var config = {
        kitId: 'eby3bgi',
        scriptTimeout: 3000,
        async: true
      },
        h = d.documentElement, t = setTimeout(function () { h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive"; }, config.scriptTimeout), tk = d.createElement("script"), f = false, s = d.getElementsByTagName("script")[0], a; h.className += " wf-loading"; tk.src = 'https://use.typekit.net/' + config.kitId + '.js'; tk.async = true; tk.onload = tk.onreadystatechange = function () { a = this.readyState; if (f || a && a != "complete" && a != "loaded") return; f = true; clearTimeout(t); try { Typekit.load(config) } catch (e) { } }; s.parentNode.insertBefore(tk, s)
    })(document);
  </script>

  <script type="text/javascript">
    window.onload = function () {
      var loadHTML = new Promise(function (resolve, reject) {
        // ia wiki から topicsデータを取得する
        {
          var url = 'http://industrial-art.sd.tmu.ac.jp/wiki/doku.php\?id=website:faculty';
          var regexp = '@<!-- CONTENT -->(.*?)<!-- \/CONTENT -->@s';
          var _html = './php/scrape.php?regexp=' + regexp + '&url=' + url;
          var replace = 'teachers';
          //Httpリクエスを作る
          var xmlhttp = new XMLHttpRequest();
          xmlhttp.open("GET", _html, true);
          xmlhttp.onreadystatechange = function () {
            //とれた場合Idにそって入れ替え
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
              var data = xmlhttp.responseText;
              //xmlhttp.responseXML
              //console.log(data);
              var elem = document.getElementById(replace);
              elem.innerHTML = data;
              resolve(data);
              //return data;
            }
          }
          xmlhttp.send(null);
        }
      });
      loadHTML.then(function () {
        // <section class="member"><img src="./images/prof-images/kusumi.jpg" alt="portrait">
        //    <section class="profile">
        //       <div class="name">
        //         <h3>楠見 清</h3><span class="position">准教授</span>
        //         <p class="name-en">Kiyoshi Kusumi</p>
        //       </div>
        //       <a href="./labview.html?id=editorial">
        //         <p class="lab">エディティングスタジオ</p>
        //       </a>
        //       <p class="research-topics">編集論、メディア論、情報コンテンツプロデュース、出版文化史</p>
        //       <a class="external-link" href="http://equipmentdesign.tumblr.com/">
        //        <span>equipmentdesign.tumblr.com</span><img src="./images/prof-link.svg">
        //       </a>
        //     </section>
        // </section
        var ols = document.getElementById('teachers').querySelector('.dw-content').querySelectorAll('ol');
        for (ol of ols) {
          var lis = ol.querySelectorAll('li');
          // [0]：名前
          // [1]：役職
          // [2]：ローマ字表記
          // [3]：スタジオ名
          // [4]：キーワード
          // [5]：研究室リンク
          // [6]：写真
          console.log(ol);
          let name = lis[0].querySelector('.li').innerHTML;
          let position = lis[1].querySelector('.li').innerHTML;
          let name_en = lis[2].querySelector('.li').innerHTML;
          let name_studio = lis[3].querySelector('.li').innerHTML;
          let keywords = lis[4].querySelector('.li').innerHTML;
          let website;
          if (lis[5].querySelector('.li').querySelector('a')) {
            website = lis[5].querySelector('.li').querySelector('a').href;
          }
          else {
            website = "";
          }

          let image_src;
          if (lis[6].querySelector('.li').querySelector('a')) {
            image_src = lis[6].querySelector('.li').querySelector('a').href;
          }
          else {
            image_src = "https://placehold.jp/5c5c5c/ffffff/300x300.png?text=no%20image";
          }

          // ここからタグを作成していく
          var section_member = document.createElement('section');
          section_member.classList = 'member';
          let img = document.createElement('img');
          img.src = image_src;
          img.style.visibility = 'hidden';
          section_member.appendChild(img);

          // img.srcが読み込み終わったら表示してあげる
          // カード画像は全部ロードが終わった後並べ替え作業をする
          img.onload = function () {
            img.style.visibility = 'visible';
            img.classList = 'fadeIn';
            console.log("loaded", img);
          }




          var section_profile = document.createElement('section');
          section_profile.classList = 'profile';
          section_member.appendChild(section_profile);
          var div_name = document.createElement('div');
          div_name.classList = 'name';
          section_profile.appendChild(div_name);
          var h3 = document.createElement('h3');
          h3.innerHTML = name;
          div_name.appendChild(h3);
          var span_position = document.createElement('span');
          span_position.classList = 'position';
          span_position.innerHTML = position;
          div_name.appendChild(span_position);
          var p_name_en = document.createElement('p');
          p_name_en.classList = 'name-en';
          p_name_en.innerHTML = name_en;
          div_name.appendChild(p_name_en);

          var p_lab = document.createElement('p');
          p_lab.classList = 'lab';
          p_lab.innerHTML = name_studio;
          section_profile.appendChild(p_lab);

          var p_keywords = document.createElement('p');
          p_keywords.classList = 'research-topics';
          p_keywords.innerHTML = keywords;
          section_profile.appendChild(p_keywords);

          var a_website = document.createElement('a');
          a_website.classList = 'external-link';
          a_website.href = website;
          a_website.innerHTML = website;
          a_website.target = '_blank';
          section_profile.appendChild(a_website);

          ol.remove();


          document.getElementById('teachers').appendChild(section_member);
          console.log(section_member);
        }
        document.getElementById('teachers').querySelector('.dw-content').remove();

      });
    }
  </script>
</head>

<body>
  <header id="global-head">
    <script>
      $("#global-head").load("./parts/header.html");
    </script>
  </header>

  <div id="nav-toggle">
    <div>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <aside id="sidebar">
    <nav id="global-nav">
      <script type="text/javascript" src="./javascript/menu.js"></script>
    </nav>
  </aside>


  <div class="wrapper">
    <div class="centering">
      <main>
        <h2 class="page-title">Faculty<span>教員紹介</span></h2>

        <section class="faculty" id="teachers">
        </section>

      </main>

      <footer>
        <script>
          $("footer").load("./parts/footer.html");
        </script>
      </footer>
    </div>
  </div>
  <section class="scroll-top"><img src="./images/page-top.svg" art="image">
    <p>PageTop</p>
  </section>

</body>

</html>